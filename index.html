<!DOCTYPE html>
<html>
<head>
  <title>Hello + Admin Test</title>
</head>
<body>

<button id="btnHello">Say Hello</button>
<p id="helloOutput"></p>

<hr>

<button id="btnAdmin">Admin</button>
<pre id="adminOutput"></pre>

<script>
const helloOutput = document.getElementById("helloOutput");
const adminOutput = document.getElementById("adminOutput");

// HELLO route
document.getElementById("btnHello").addEventListener("click", async () => {
    try {
        const res = await fetch("http://localhost:3000/hello");
        const text = await res.text();
        helloOutput.innerText = "Status: " + res.status + " â†’ " + text;
    } catch (err) {
        helloOutput.innerText = "Error: " + err.message;
    }
});

// ADMIN route
document.getElementById("btnAdmin").addEventListener("click", async () => {
    try {
        const res = await fetch("http://localhost:3000/admin", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "x-secret-key": "admin123"
            },
            body: JSON.stringify({
                userId: 1,
                name: "eee",
                role: "Admin"
            })
        });

        const data = await res.json();

        
        if (res.status === 409) {
            adminOutput.innerText =
                "Status: 409\n" +
                "Message: User already exists";
            return;
        }


        if (res.ok && data.newUser) {
            adminOutput.innerText =
                "Status: " + res.status + "\n" +
                "UserId: " + data.newUser.userId + "\n" +
                "Name: " + data.newUser.name + "\n" +
                "Role: " + data.newUser.role;
        } else {
            adminOutput.innerText =
                "Status: " + res.status + "\nMessage: " + (data.message || "Unknown error");
        }

    } catch (err) {
        adminOutput.innerText = "Fetch Error: " + err.message;
    }
});
</script>

</body>
</html>
